<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.7fa2803f852aa0b554a9.css">@import url(https://fonts.googleapis.com/css?family=Work+Sans&display=swap);html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;font-size:16px}body{margin:0;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{box-sizing:border-box;overflow-y:scroll}*,:after,:before{box-sizing:inherit}body{color:rgba(0,0,0,.8);font-family:Helvetica Neue,sans-serif;font-weight:400;word-wrap:break-word;-webkit-font-kerning:normal;font-kerning:normal;-ms-font-feature-settings:"kern","liga","clig","calt";font-feature-settings:"kern","liga","clig","calt"}img{max-width:100%;padding:0;margin:0 0 1.45rem}h1{font-size:2.25rem}h1,h2{padding:0;margin:0 0 1.45rem;color:inherit;font-family:Helvetica Neue,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h2{font-size:1.62671rem}h3{font-family:Helvetica Neue,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,sans-serif;font-size:1.38316rem}h3,h4{padding:0;margin:0 0 1.45rem;color:inherit;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h4{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-size:1rem}h5{font-size:.85028rem}h5,h6{padding:0;margin:0 0 1.45rem;color:inherit;font-family:Helvetica Neue,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h6{font-size:.78405rem}hgroup{padding:0;margin:0 0 1.45rem}ol,ul{padding:0;margin:0 0 1.45rem 1.45rem;list-style-position:outside;list-style-image:none}dd,dl,figure,p{padding:0;margin:0 0 1.45rem}pre{margin:0 0 1.45rem;font-size:.85rem;line-height:1.42;background:rgba(0,0,0,.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.45rem}table{font-size:1rem;line-height:1.45rem;border-collapse:collapse;width:100%}fieldset,table{padding:0;margin:0 0 1.45rem}blockquote{padding:0;margin:0 1.45rem 1.45rem}form,iframe,noscript{padding:0;margin:0 0 1.45rem}hr{padding:0;margin:0 0 calc(1.45rem - 1px);background:rgba(0,0,0,.2);border:none;height:1px}address{padding:0;margin:0 0 1.45rem}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-left:1.45rem;margin-bottom:.725rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{border-bottom:1px solid rgba(0,0,0,.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:rgba(0,0,0,.04);border-radius:3px;font-family:SFMono-Regular,Consolas,Roboto Mono,Droid Sans Mono,Liberation Mono,Menlo,Courier,monospace;padding:.2em 0}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{letter-spacing:-.2em;content:" "}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}@media only screen and (max-width:480px){html{font-size:100%}}body{font-family:Work Sans,Helvetica Neue,Helvetica,sans-serif;overflow-x:hidden;color:#000;font-size:16px}a{text-decoration:none;color:inherit}a,a:hover{transition:opacity .2s ease}a:hover{opacity:.5;-webkit-text-decoration-color:inherit;text-decoration-color:inherit}ul{list-style:none;margin:0}h1,h2,h3,h4,h5,h6,p{font-family:Work Sans,Helvetica Neue,Helvetica,sans-serif}h1,h2{font-weight:500}h1{font-size:2rem;letter-spacing:-1px;line-height:1.1875}h2{font-size:1.7rem;letter-spacing:-.75px;line-height:1.2}h3{line-height:1.1875;color:#a0a0a0;font-weight:400}h3,p{font-size:1.2rem;letter-spacing:-.5px}p{line-height:1.5;color:#464646}.gatsby-image-wrapper{width:100%;height:100%;min-height:100%}@media (min-width:1280px){h1{font-size:2rem;letter-spacing:-1px;line-height:1.1875}h2{font-size:1.5rem;letter-spacing:-.75px;line-height:1.1667}h3{letter-spacing:-.5px;line-height:1.1875;color:#a0a0a0;font-weight:400}p{line-height:1.4375}}.header-module--header--nTqsH h1{margin-bottom:0}.header-module--header__nav--1YBPD{padding:1.5rem 1.25rem;border-bottom:1px solid #ebebeb;display:flex;justify-content:space-between;flex-direction:row;align-items:center}.header-module--header__nav--1YBPD img{margin-bottom:0}@media (min-width:768px){.header-module--header--nTqsH{height:100vh;width:30%;position:fixed;left:0;top:0}.header-module--header__nav--1YBPD{padding:2rem;height:100%;border-right:1px solid #ebebeb;border-bottom:none;flex-direction:column;align-items:flex-start}.header-module--header__nav--1YBPD img{margin-bottom:0}}.layout-module--layout--3hAzY{display:flex;flex-direction:column;min-height:100vh}.layout-module--layout--3hAzY.layout-module--info_page--3r_Kf{color:#000}.layout-module--content--1Y4HW{flex-grow:1}@media (min-width:768px){.layout-module--layout--3hAzY{display:block}.layout-module--content--1Y4HW{flex-grow:none;width:70%;margin-left:30%}}._404-module--not-found__container--1BEsg{width:100%;height:100vh;display:flex;justify-content:center;align-items:center}.bloglist-module--list--2GOEg a:hover{opacity:1}.bloglist-module--list--2GOEg a:hover li .bloglist-module--list__hero--lTLp8 div picture{opacity:.8;transition:opacity .3s ease}.bloglist-module--list--2GOEg .bloglist-module--list__hero--lTLp8{width:100%;height:33vh;overflow:hidden;background-color:#000}.bloglist-module--list--2GOEg .bloglist-module--list__hero--lTLp8 img{-o-object-fit:cover;object-fit:cover;-o-object-position:50% 50%;object-position:50% 50%;min-height:100%}.bloglist-module--list--2GOEg .bloglist-module--list__hero--lTLp8 div picture{opacity:1;transition:opacity .3s ease}.bloglist-module--list--2GOEg .bloglist-module--list__info--NFYym{display:flex;flex-direction:column;justify-content:center;padding:1.5rem 1.25rem;border-bottom:1px solid #ebebeb}.bloglist-module--list--2GOEg .bloglist-module--list__info--NFYym h2,.bloglist-module--list--2GOEg .bloglist-module--list__info--NFYym h3,.bloglist-module--list--2GOEg .bloglist-module--list__info--NFYym p{transform:translateX(0);transition:transform .5s ease-out}.bloglist-module--list--2GOEg li{opacity:inherit;display:flex;justify-content:center;flex-direction:column;min-height:38vh;margin-bottom:0}.bloglist-module--list--2GOEg h2{margin-bottom:.5rem}.bloglist-module--list--2GOEg h3{margin-bottom:1rem}.bloglist-module--list--2GOEg p{max-width:900px}@media (min-width:768px){.bloglist-module--list--2GOEg a:hover{opacity:1}.bloglist-module--list--2GOEg a:hover li div.bloglist-module--list__info--NFYym h2,.bloglist-module--list--2GOEg a:hover li div.bloglist-module--list__info--NFYym h3,.bloglist-module--list--2GOEg a:hover li div.bloglist-module--list__info--NFYym p{transform:translateX(10px);transition:transform .5s ease-out}.bloglist-module--list--2GOEg li{min-height:250px;height:33.333vh;flex-direction:row}.bloglist-module--list--2GOEg .bloglist-module--list__hero--lTLp8{height:100%}.bloglist-module--list--2GOEg .bloglist-module--list__hero--lTLp8 img{min-width:100%;height:100%;width:auto;min-height:0}.bloglist-module--list--2GOEg .bloglist-module--list__info--NFYym{min-width:70%}}@media (min-width:1280px){.bloglist-module--list--2GOEg .bloglist-module--list__info--NFYym{padding:3rem}.bloglist-module--list--2GOEg h3{margin-bottom:1.2rem}}.info-module--info_blurb--DoQ9H{max-width:800px;padding:1.5rem 1.25rem}.info-module--info_blurb--DoQ9H p{color:#000;font-size:1.4rem}.info-module--info_blurb--DoQ9H h2 div p{margin-bottom:1rem}@media (min-width:768px){.info-module--info_blurb--DoQ9H{padding:2rem}}@media (min-width:1440px){.info-module--info_blurb--DoQ9H{padding:3rem}}.blog-module--blog--3r4FP h1{margin-bottom:.7rem}.blog-module--blog__hero--3M-se{min-height:300px;height:60vh;width:100%;margin:0}.blog-module--blog__hero--3M-se img{margin-bottom:0;-o-object-fit:cover;object-fit:cover}.blog-module--blog__info--1Sdps{padding:1.5rem 1.25rem;width:100%;max-width:768px;margin:0 auto}.blog-module--blog__info--1Sdps h1{margin-bottom:.66rem}.blog-module--blog__info--1Sdps h3{margin-bottom:0}.blog-module--blog__body--quQB6{width:100%;padding:0 1.25rem;margin:0 auto;display:flex;flex-direction:column;justify-content:center}.blog-module--blog__body--quQB6 a{padding-bottom:1.5rem}.blog-module--blog__body--quQB6 :last-child{margin-bottom:0}.blog-module--blog__body--quQB6 h1,.blog-module--blog__body--quQB6 h2,.blog-module--blog__body--quQB6 h3,.blog-module--blog__body--quQB6 h4,.blog-module--blog__body--quQB6 h5,.blog-module--blog__body--quQB6 h6{font-weight:400;padding:1.5rem 1rem;line-height:1.2}.blog-module--blog__body--quQB6 p{color:#464646;font-weight:400}.blog-module--blog__body--quQB6 ul{list-style:initial}.blog-module--blog__body--quQB6 ol,.blog-module--blog__body--quQB6 ul{margin-left:1.25rem;margin-bottom:1.25rem;padding-left:1.45rem}.blog-module--blog__footer--_YBtb{display:flex;justify-content:space-between;align-items:center;padding:1.5rem 1.25rem;width:100%;max-width:800px;margin:0 auto}.blog-module--blog__footer--_YBtb h2{margin-bottom:0}.blog-module--blog__footer--_YBtb a{display:flex;justify-content:space-between;align-items:center}.blog-module--blog__footer--_YBtb a svg{width:20px}@media (min-width:768px){.blog-module--blog--3r4FP{display:flex;flex-direction:column}.blog-module--blog__body--quQB6{max-width:800px;padding:0 2rem}.blog-module--blog__body--quQB6 h1,.blog-module--blog__body--quQB6 h2,.blog-module--blog__body--quQB6 h3,.blog-module--blog__body--quQB6 h4,.blog-module--blog__body--quQB6 h5,.blog-module--blog__body--quQB6 h6{padding:1.5rem}.blog-module--blog__body--quQB6 span{width:100%;margin:1rem auto}.blog-module--blog__body--quQB6 ol,.blog-module--blog__body--quQB6 ul{margin-left:1.5rem;margin-bottom:1.5rem}.blog-module--blog__hero--3M-se{min-height:600px;height:75vh}.blog-module--blog__hero--3M-se img{min-width:100%}.blog-module--blog__info--1Sdps{text-align:center;padding:2rem 0}.blog-module--blog__info--1Sdps h1{max-width:500px;margin:0 auto .66rem}.blog-module--blog__footer--_YBtb{padding:2.25rem}}@media (min-width:1440px){.blog-module--blog__hero--3M-se{height:70vh}.blog-module--blog__info--1Sdps{padding:3rem 0}.blog-module--blog__footer--_YBtb{padding:2rem 2rem 3rem}}</style><meta name="generator" content="Gatsby 2.22.9"/><title data-react-helmet="true">Tom Rodrigues</title><meta data-react-helmet="true" name="description" content="A blog for Tom Rodrigues"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><link as="script" rel="preload" href="/webpack-runtime-96bb2e4ba595181da7e0.js"/><link as="script" rel="preload" href="/framework-90f0b3ff04962f883af6.js"/><link as="script" rel="preload" href="/app-777f68bc172577153133.js"/><link as="script" rel="preload" href="/styles-9b6f388623a2ec93d35f.js"/><link as="script" rel="preload" href="/commons-8962c900629888d33e9d.js"/><link as="script" rel="preload" href="/bacebdf6d0bf517fa17dd17cb191a4a547a45f91-fc2770e5139ee3515fa0.js"/><link as="script" rel="preload" href="/component---src-templates-blog-js-3c5561086e9db448afc8.js"/><link as="fetch" rel="preload" href="/page-data/blog/my-diy-smart-thermostat/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><section class="layout-module--layout--3hAzY false"><header class="header-module--header--nTqsH false"><nav class="header-module--header__nav--1YBPD" role="navigation" aria-label="main navigation"><a href="/"><h1>Tom Rodrigues</h1></a><div><h1><a href="/info">info</a></h1></div></nav></header><div class="layout-module--content--1Y4HW"><article class="blog-module--blog--3r4FP"><figure class="blog-module--blog__hero--3M-se"><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden"><div aria-hidden="true" style="width:100%;padding-bottom:67.2%"></div><img aria-hidden="true" src="data:image/jpeg;base64,/9j/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjL/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAID/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAT/2gAMAwEAAhADEAAAAZhtbBiof//EABsQAAICAwEAAAAAAAAAAAAAAAECAAMEERMS/9oACAEBAAEFAvS7Ng10qiCOvSJiIR//xAAZEQABBQAAAAAAAAAAAAAAAAAAAwQREhP/2gAIAQMBAT8Bq3gwRP/EABgRAAIDAAAAAAAAAAAAAAAAAAARAwQT/9oACAECAQE/AXZZtMf/xAAdEAACAgEFAAAAAAAAAAAAAAAAEQEhMRIiQXGB/9oACAEBAAY/AqXo1q6MwRmjc5OT/8QAGxAAAgIDAQAAAAAAAAAAAAAAASEAETFBUXH/2gAIAQEAAT8hKBAPUQnasoN4TEBfFwIC9GHCRjRrM//aAAwDAQACAAMAAAAQoy//xAAdEQABAgcAAAAAAAAAAAAAAAAAAREhMUFxodHh/9oACAEDAQE/EJNo2XY9XHD/xAAdEQABAgcAAAAAAAAAAAAAAAAAAREhMXHB0eHw/9oACAECAQE/EJl4VTFzp9n/xAAcEAEBAQEAAgMAAAAAAAAAAAABESEAMWFBgbH/2gAIAQEAAT8Qg05iBnt4gBBsFffEIY8lX84iuxTVd1zfL15TFRLvwHSuxx5e29//2Q==" alt="My DIY Smart Thermostat" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source srcset="/static/2f08f7bf723cf42a6a79deabc50d8b18/8def4/hero.jpg 375w,
/static/2f08f7bf723cf42a6a79deabc50d8b18/35c3d/hero.jpg 750w,
/static/2f08f7bf723cf42a6a79deabc50d8b18/398d8/hero.jpg 1500w,
/static/2f08f7bf723cf42a6a79deabc50d8b18/0e37b/hero.jpg 2250w,
/static/2f08f7bf723cf42a6a79deabc50d8b18/29c03/hero.jpg 2546w" sizes="(max-width: 1500px) 100vw, 1500px" /><img loading="lazy" sizes="(max-width: 1500px) 100vw, 1500px" srcset="/static/2f08f7bf723cf42a6a79deabc50d8b18/8def4/hero.jpg 375w,
/static/2f08f7bf723cf42a6a79deabc50d8b18/35c3d/hero.jpg 750w,
/static/2f08f7bf723cf42a6a79deabc50d8b18/398d8/hero.jpg 1500w,
/static/2f08f7bf723cf42a6a79deabc50d8b18/0e37b/hero.jpg 2250w,
/static/2f08f7bf723cf42a6a79deabc50d8b18/29c03/hero.jpg 2546w" src="/static/2f08f7bf723cf42a6a79deabc50d8b18/398d8/hero.jpg" alt="My DIY Smart Thermostat" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div></figure><div class="blog-module--blog__info--1Sdps"><h1>My DIY Smart Thermostat</h1><h3>April 17th, 2020</h3></div><div class="blog-module--blog__body--quQB6"><p>It's never been easier to make your home's heating smart — there's a seemingly endless number of smart thermostats available, like those from <a href="https://store.google.com/us/magazine/compare_thermostats?hl=en-US&#x26;GoogleNest&#x26;utm_source=nest_redirect&#x26;utm_medium=google_oo&#x26;utm_campaign=GS103056&#x26;utm_term=thermostats">Nest</a> and <a href="https://www.honeywellhome.com/en/products/thermostat">Honeywell</a>.</p>
<p>Of course, as I outlined in my post about <a href="https://tommrodrigues.github.io/blog/my-dollar99-apple-smart-home">My $99 Apple Smart Home</a>, not all of us are willing to foot the $100+ price tag that comes with many of these smart devices.</p>
<p>This is what led me on my quest to design and build my very own smart thermostat for less than $10 using some cheap electronics and <a href="https://github.com/homebridge/homebridge">Homebridge</a>.</p>
<p>This post outlines how I achieved my goal, see <a href="https://github.com/Tommrodrigues/homebridge-web-boiler/tree/master/examples">here</a> for more of a technical how-to.</p>
<h2>OpenTherm</h2>
<p><a href="https://en.wikipedia.org/wiki/OpenTherm">OpenTherm</a> is a protocol used by many modern central heating systems to allow communication between a boiler and a thermostat.</p>
<p>The protocol is widely used across Europe and elsewhere in the world — chances are that if you have a relatively new boiler (within the last decade or so), you'll have support for the protocol.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 66.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjL/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIDBv/EABUBAQEAAAAAAAAAAAAAAAAAAAEC/9oADAMBAAIQAxAAAAHmKVLbYP8A/8QAGhAAAgIDAAAAAAAAAAAAAAAAAQIAExIUIf/aAAgBAQABBQKws4cgu4aVdrmrkP/EABcRAQADAAAAAAAAAAAAAAAAAAABERL/2gAIAQMBAT8BpiX/xAAXEQEAAwAAAAAAAAAAAAAAAAAAARES/9oACAECAQE/Abah/8QAHRAAAgIBBQAAAAAAAAAAAAAAAAECEaESITEyUf/aAAgBAQAGPwKT9dlpicpbnJ2wXrwf/8QAGxABAAICAwAAAAAAAAAAAAAAAQARITFBsfD/2gAIAQEAAT8htPbKWYCRLIzNzBnWDeEFRbHu5//aAAwDAQACAAMAAAAQdA//xAAYEQACAwAAAAAAAAAAAAAAAAAAARExYf/aAAgBAwEBPxBPUGB//8QAFxEAAwEAAAAAAAAAAAAAAAAAAAFRYf/aAAgBAgEBPxBrTc//xAAeEAEAAgEEAwAAAAAAAAAAAAABABEhMUFxgcHh8P/aAAgBAQABPxBcdAQbrmGKDImoxiiG9lW31LEHPnzHq+HcUtGB/9k='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="image"
        title="image"
        src="/static/456c021f438104641c18bbf41d97cf5c/4edc6/radiator.jpg"
        srcset="/static/456c021f438104641c18bbf41d97cf5c/b6501/radiator.jpg 250w,
/static/456c021f438104641c18bbf41d97cf5c/bb312/radiator.jpg 500w,
/static/456c021f438104641c18bbf41d97cf5c/4edc6/radiator.jpg 1000w,
/static/456c021f438104641c18bbf41d97cf5c/92dea/radiator.jpg 1500w,
/static/456c021f438104641c18bbf41d97cf5c/cbe2c/radiator.jpg 2000w,
/static/456c021f438104641c18bbf41d97cf5c/2e69d/radiator.jpg 2550w"
        sizes="(max-width: 1000px) 100vw, 1000px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>The first question is: how do you get something like a <a href="https://www.nodemcu.com/index_en.html">NodeMCU</a> to talk to a boiler using the OpenTherm protocol?</p>
<p>Well, thankfully, most of the work has already been done for us.</p>
<p><a href="http://ihormelnyk.com/arduino_opentherm_controller">This</a> blog outlines how to make an OpenTherm adapter to act as the interface between our NodeMCU, and our OpenTherm-compatible appliance.</p>
<p>The circuit diagram is as follows:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 930px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 42%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAACmGAAAphgEi7N+MAAABhklEQVQoz01Sa2+rMAzt//9h+zJp0qp2d5QC4VVKnoQQVp7nNp4qzZJlcOzjc5wc9n1H8HVdsSwL+bZt9B+sH3rE1xh/LZyHnmCv+LLDK9l1HYZhgBscvPcQUiApEggjkJc5pJXobAelFLIsI/+Zf5AXOayzmNcZUshfQGMMOU3fN/oOjW/vb2iaBtNjQu96XNkVggvM84wkSVDrGnd+R2taGG/gB49DKI7iCMfoCK01gbreQRoJNzoqesmv6gqcc4zjiNPpRKr2bccyL3hMD0j5ZJhWKaIywr29I61Tkl9VFS7xBX70JD802d4izmLkeY40TfF5/ESrWiiraM/KPKPtcVi3FUme4OP8gSzPfhk6h67vILSAkopAlVZIixS3240Gfkff4IajrEtS0/kOWmkctNFw3iHEMCHshFUMXHA0bUOs6ltNOZYzYkfyn6BFWeCSXjDNE5Z1wTRNT8Beww4WvOWw1lLR+d+Zbi/sLACGHKsZvuIvMMaoMWMZ5YLU8DJa2RKh/9oMXI/o/WWFAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="image"
        title="image"
        src="/static/a9bb262bd46cad13247d24fa4db05876/9e209/schematic.png"
        srcset="/static/a9bb262bd46cad13247d24fa4db05876/41b2e/schematic.png 250w,
/static/a9bb262bd46cad13247d24fa4db05876/36a81/schematic.png 500w,
/static/a9bb262bd46cad13247d24fa4db05876/9e209/schematic.png 930w"
        sizes="(max-width: 930px) 100vw, 930px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>Nothing too complicated, just some resistors, diodes, opto-couplers, and transistors.</p>
<p>However, if you've never had experience making your own circuits, and the schematic above scares you, you might feel more comfortable buying a pre-made adaptor from the <a href="http://ihormelnyk.com/shop/arduino_opentherm_controller">blog</a>.</p>
<p>Otherwise, if you're willing to give it a shot, and would rather not spend $15 dollars on something you can make yourself for less than $10, simply buy the components listed on the blog, and solder them to some perfboard.</p>
<p>If you want to be super fancy, I've designed a PCB <a href="https://github.com/Tommrodrigues/homebridge-web-boiler/tree/master/examples/OpenTherm%20PCB">here</a> which you could send off to be made for a couple of dollars, and save yourself a lot of headache when it comes to soldering soldering the components you've ordered!</p>
<p>Once you've got your OpenTherm adapter, we're nearly there!</p>
<p>All that's left for hardware is something to feed in the ambient temperature to the NodeMCU. For this, I chose the DHT11 temperature sensor.</p>
<h2>Building the thermostat</h2>
<p>Once we've wired the sensor and the adaptor up to the NodeMCU and connected everything to the boiler, we just need to focus on the software.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 66.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjL/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEAf/EABUBAQEAAAAAAAAAAAAAAAAAAAMB/9oADAMBAAIQAxAAAAFiosNLyAO//8QAHBAAAgEFAQAAAAAAAAAAAAAAAQIAAwQREhMi/9oACAEBAAEFAuyZFy4TupgbQtV97z//xAAYEQADAQEAAAAAAAAAAAAAAAAAAhIBMf/aAAgBAwEBPwGVXpGH/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAECEjH/2gAIAQIBAT8BVu+G2f/EAB0QAAIBBAMAAAAAAAAAAAAAAAABMgIRIZEiMXH/2gAIAQEABj8CaIOrOjtbLy9FxWSKP//EABwQAQADAAIDAAAAAAAAAAAAAAEAESExgVFxwf/aAAgBAQABPyEAF4Cp6iDR0pDck+GFsXTkd3HX6ZxHfxn/2gAMAwEAAgADAAAAEEv/AP/EABcRAAMBAAAAAAAAAAAAAAAAAAERIRD/2gAIAQMBAT8QRKSYf//EABoRAAEFAQAAAAAAAAAAAAAAAAABESExYaH/2gAIAQIBAT8QUmtPDI//xAAdEAEBAAICAwEAAAAAAAAAAAABEQAhMVFBcYHx/9oACAEBAAE/EC4TqJzoC9VHFRU0FiHHaav3Axm5AI9YajhpgOp+YlBiTTHu+Mk6724//9k='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="image"
        title="image"
        src="/static/d6ccd69e4854447d1509d0255d93832d/4edc6/making.jpg"
        srcset="/static/d6ccd69e4854447d1509d0255d93832d/b6501/making.jpg 250w,
/static/d6ccd69e4854447d1509d0255d93832d/bb312/making.jpg 500w,
/static/d6ccd69e4854447d1509d0255d93832d/4edc6/making.jpg 1000w,
/static/d6ccd69e4854447d1509d0255d93832d/92dea/making.jpg 1500w,
/static/d6ccd69e4854447d1509d0255d93832d/cbe2c/making.jpg 2000w,
/static/d6ccd69e4854447d1509d0255d93832d/013da/making.jpg 2549w"
        sizes="(max-width: 1000px) 100vw, 1000px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>The NodeMCU will use a <a href="https://en.wikipedia.org/wiki/PID_controller">PID controller</a> to control the boiler's temperature based on the ambient temperature.</p>
<p>The PID tracks changes to the ambient temperature, adjusting the boiler's output to get the ambient temperature as close to the desired temperature as possible.</p>
<p>Simply, if it's too warm, cool down the boiler, and vice-versa.</p>
<p>The NodeMCU manages all this for you and relays the information back to the <a href="https://github.com/Tommrodrigues/homebridge-web-boiler">homebridge-web-boiler</a> plugin, so all you need to do is set the desired temperature in <a href="https://www.apple.com/ios/home/">Apple HomeKit</a> — the rest will be taken care of.</p>
<h2>Tuning</h2>
<p>The PID controller uses some set values to work out how it should behave.</p>
<p>For example, if your home is well insulated, it may require more even heating over a longer period of time. Another home might instead lose heat more quickly, so the controller should be more sensitive to sudden changes.</p>
<p>The values the PID uses are: Kp, Ki, and Kd. You can look up PID controller theory if you want more information on what each of the values are responsible for — but just know that these values will vary between homes.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 66.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjL/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAwAEBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAD/9oADAMBAAIQAxAAAAEXyhSPSij/xAAbEAEBAAEFAAAAAAAAAAAAAAABAgADEiEiI//aAAgBAQABBQIrtPM7yWvPJ11wUP/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAECAQE/AUf/xAAaEAACAgMAAAAAAAAAAAAAAAAAIQEREBJB/9oACAEBAAY/AnOsDOiKrH//xAAYEAEBAQEBAAAAAAAAAAAAAAABEQAhMf/aAAgBAQABPyEngk+F7mAjuVDGizEsmT5GFdt7v//aAAwDAQACAAMAAAAQF8//xAAWEQADAAAAAAAAAAAAAAAAAAAAARH/2gAIAQMBAT8QjKz/xAAWEQEBAQAAAAAAAAAAAAAAAAAAATH/2gAIAQIBAT8QxT//xAAdEAEBAQABBQEAAAAAAAAAAAABEQAxIUFRcbHB/9oACAEBAAE/EBwwRsQMn3cXo1Dv+aE1W8PgwgjJMTqk9YzOSUcfrYEu/9k='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="image"
        title="image"
        src="/static/da430c2c8ba92ee7ffbaa3fe4523868e/4edc6/tuning.jpg"
        srcset="/static/da430c2c8ba92ee7ffbaa3fe4523868e/b6501/tuning.jpg 250w,
/static/da430c2c8ba92ee7ffbaa3fe4523868e/bb312/tuning.jpg 500w,
/static/da430c2c8ba92ee7ffbaa3fe4523868e/4edc6/tuning.jpg 1000w,
/static/da430c2c8ba92ee7ffbaa3fe4523868e/92dea/tuning.jpg 1500w,
/static/da430c2c8ba92ee7ffbaa3fe4523868e/cbe2c/tuning.jpg 2000w,
/static/da430c2c8ba92ee7ffbaa3fe4523868e/2e69d/tuning.jpg 2550w"
        sizes="(max-width: 1000px) 100vw, 1000px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>A <a href="http://brettbeauregard.com/blog/2012/01/arduino-pid-autotune-library/">PID auto-tuner</a> included on the NodeMCU makes finding the right values for your home easy.</p>
<p>Once you've set your thermostat up, you should run the auto-tuner when the ambient temperature and the boiler temperature are stable.</p>
<p>The auto-tuner will oscillate the boiler temperature very high and very low to see how the ambient temperature reacts. Note that this may take a few hours, and your home may become uncomfortably warm/cool whilst tuning is taking place</p>
<p>From the tuning, the NodeMCU can back-calculate figures for each of the PID values for your home. These are ballpark figures, and will require finer manual tuning to optimise them.</p>
<h2>Conclusion</h2>
<p>Building your own smart thermostat is a relatively simple, and ultimately very rewarding task.</p>
<p>This DIY smart thermostat was a major addition to my smart home, and my family loves being able to control and schedule the heating easily from their phones.</p>
<p>I was also able to save more than $100, and the tuned PID controller does a far superior job maintaining a comfortable ambient temperature in my home than any of our previous thermostats have done.</p>
<h2>Links</h2>
<ul>
<li><a href="https://github.com/Tommrodrigues/homebridge-web-boiler/tree/master/examples">Smart Thermostat</a></li>
<li><a href="https://github.com/Tommrodrigues/homebridge-web-boiler">homebridge-web-boiler</a></li>
<li><a href="http://brettbeauregard.com/blog/2012/01/arduino-pid-autotune-library/">PID Auto-tuner Post</a></li>
<li><a href="https://tommrodrigues.github.io/blog/my-dollar99-apple-smart-home">My $99 Apple Smart Home</a></li>
<li><a href="http://ihormelnyk.com/arduino_opentherm_controller">Opentherm Adapter Post</a></li>
<li><a href="https://github.com/Tommrodrigues/homebridge-web-boiler/tree/master/examples/OpenTherm%20PCB">OpenTherm Adapter PCB</a></li>
</ul>
<p>P.S. Buy your parts from AliExpress, it's way cheaper than Amazon!</p></div><div class="blog-module--blog__footer--_YBtb"><h2>Written By: <!-- -->Tom Rodrigues</h2><a href="/blog/my-dollar99-apple-smart-home"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" x="0px" y="0px" viewBox="0 0 26 26" enable-background="new 0 0 26 26"><path d="M23.021,12.294l-8.714-8.715l-1.414,1.414l7.007,7.008H2.687v2h17.213l-7.007,7.006l1.414,1.414l8.714-8.713  C23.411,13.317,23.411,12.685,23.021,12.294z"></path></svg></a></div></article></div></section></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-163903660-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/my-diy-smart-thermostat";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-777f68bc172577153133.js"],"component---src-pages-404-js":["/component---src-pages-404-js-22b35d38d557c67168e0.js"],"component---src-pages-index-js":["/component---src-pages-index-js-6ceba8f3625f752fba4f.js"],"component---src-pages-info-js":["/component---src-pages-info-js-a80ee9734999ed206a78.js"],"component---src-templates-blog-js":["/component---src-templates-blog-js-3c5561086e9db448afc8.js"]};/*]]>*/</script><script src="/component---src-templates-blog-js-3c5561086e9db448afc8.js" async=""></script><script src="/bacebdf6d0bf517fa17dd17cb191a4a547a45f91-fc2770e5139ee3515fa0.js" async=""></script><script src="/commons-8962c900629888d33e9d.js" async=""></script><script src="/styles-9b6f388623a2ec93d35f.js" async=""></script><script src="/app-777f68bc172577153133.js" async=""></script><script src="/framework-90f0b3ff04962f883af6.js" async=""></script><script src="/webpack-runtime-96bb2e4ba595181da7e0.js" async=""></script></body></html>